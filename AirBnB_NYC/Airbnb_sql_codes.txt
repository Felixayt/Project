/*1. What are the most popular neighborhoods for short-term rentals in
 New York City?*/

 /*SELECT COUNT(pr.listing_id),ty.room_type
 FROM prices as pr
 JOIN room_types ty
 USING(listing_id)
 GROUP BY room_type;*/

 /*SELECT COUNT(listing_id),neighbourhood
 FROM prices 
 GROUP BY neighbourhood
 ORDER BY 1 DESC;*/
--2. What is the average rental price for short-term rentals in 
--New York City, and how does it vary by neighborhood and property type?

/*SELECT AVG(price),neighbourhood,ty.room_type
from prices pr
JOIN room_types ty
USING (listing_id)
group by 2,3
order by 1 DESC;*/

/*3. What are the most commonly rented property types on Airbnb in New 
York City, and how does this vary by neighborhood?*/

/*SELECT AVG(re.booked_days_365),ty.room_type,neighbourhood
from reviews re
JOIN room_types ty
USING (listing_id)
JOIN prices pr
USING(listing_id)
group by 2,3
order by 1 DESC;*/

/*4. What is the average length of stay for short-term 
rentals in New York City, and how does this vary by neighborhood
and property type?*/

--What is the most common room type in NYC Airbnb listings?- entire home/apt (13266)

Select COUNT(listing_id),room_type
from room_types
group by 2
order by 1 desc;

--What is the average price of a listing by room type? - EH - 197.17,PR 81.67,SH 53.65
SELECT ROUND(AVG(price),2), ty.room_type
from prices pr 
join room_types ty
USING(listing_id)
GROUP BY 2;

--Which borough has the highest average price per month?-Manhattan- 5596
SELECT AVG(price_per_month),MAX(price_per_month),MIN(price_per_month),borough
from prices
group by 4
order by 1 DESC;

--How many listings of each room type are in each borough?

SELECT COUNT(re.listing_id),ty.room_type,pr.borough
from prices pr
JOIN room_types ty
USING (listing_id)
JOIN reviews re
USING(listing_id)
group by 2,3
order by 1 DESC;

--How many listings in each room type category have a price of 
--over $500 per night?

SELECT COUNT(pr.listing_id),ty.room_type
FROM prices pr
JOIN room_types ty
USING(listing_id)
WHERE price > 500
GROUP BY 2;

--What is the distribution of listing prices by neighborhood?- Brooklyn East Flatbush - 7500
SELECT AVG(price),MAX(price),MIN(price),neighbourhood,borough
from prices
group by 4,5
order by 2 DESC;

--What is the estimated amount of
-- revenue generated by hosts in each borough?

SELECT SUM(price * booked_days_365),
 borough
from prices pr
Join reviews re
USING(listing_id)
Group by 2;

SELECT COUNT(pr.listing_id),
 host_name,borough
from prices pr
Join reviews re
USING(listing_id)
Group by 2,3;

/*SELECT COUNT(re.listing_id),ty.room_type,pr.borough
from prices pr
JOIN room_types ty
USING (listing_id)
JOIN reviews re
USING(listing_id)
group by 2,3
order by 1 DESC;*/

/*SELECT COUNT(pr.listing_id),ty.room_type
FROM prices pr
JOIN room_types ty
USING(listing_id)
WHERE price > 500
GROUP BY 2;*/

/*SELECT AVG(price),MAX(price),MIN(price),neighbourhood,borough
from prices
group by 4,5
order by 2 DESC;*/

/*SELECT SUM(price * booked_days_365),
 borough
from prices pr
Join reviews re
USING(listing_id)
Group by 2;*/

/*SELECT AVG(price_per_month),room_type,neighbourhood
from prices pr
join room_types ty
USING(listing_id)
group by 2,3
order by 1 DESC;*/
